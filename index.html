<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seattle Housing Affordability Dashboard</title>

  <!-- Mapbox GL JS — renders the interactive map -->
  <!-- Uses Web Mercator (EPSG:3857) by default, which is standard for web maps -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>

  <!-- D3.js — used to load local GeoJSON/CSV files -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"></script>

  <!-- C3.js — builds the linked charts in the side panel -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700&family=Barlow:wght@300;400;500&display=swap" rel="stylesheet" />

  <!-- Custom styles -->
  <link href="css/style.css" rel="stylesheet" />
</head>

<body>
  <div id="app">

    <!-- ========== TOP NAVIGATION BAR ========== -->
    <nav id="navbar">
      <div id="nav-brand">
        <span class="nav-dot"></span>
        <span>Seattle Housing Affordability</span>
      </div>
      <div id="nav-links">
        <a href="landing.html">Home</a>
        <a href="index.html" class="active">Dashboard</a>
        <a href="about.html">About</a>
      </div>
    </nav>

    <!-- ========== MAIN LAYOUT: left panel + map ========== -->
    <div id="dashboard">

      <!-- ===== LEFT INFO PANEL ===== -->
      <div id="info-panel">

        <!-- Panel header -->
        <div class="panel-header">
          <h2>MHA Zones &amp; Rent Burden</h2>
          <p class="panel-subtitle">Seattle, WA · 2006–2022</p>
        </div>

        <!-- Dynamic stat: rent burden for selected year -->
        <div class="stat-block">
          <p class="stat-label">Citywide Rent Burden Rate</p>
          <div id="burden-stat">–</div>
          <p class="stat-sub" id="burden-year-label">All renters · select a year</p>
        </div>

        <!-- ---- YEAR SLIDER ---- -->
        <div class="control-block">
          <div class="control-header">
            <p class="control-label">Year</p>
            <span id="year-display" class="year-badge">2022</span>
          </div>
          <input
            type="range"
            id="year-slider"
            min="2006"
            max="2022"
            step="1"
            value="2022"
          />
          <div class="slider-ticks">
            <span>2006</span>
            <span>2010</span>
            <span>2014</span>
            <span>2018</span>
            <span>2022</span>
          </div>
        </div>

        <!-- ---- RACE FILTER TOGGLES ---- -->
        <div class="control-block">
          <p class="control-label">Filter by Group</p>
          <div id="race-filters">
            <button class="race-btn active" data-race="All">All</button>
            <button class="race-btn" data-race="White">White</button>
            <button class="race-btn" data-race="Black">Black</button>
            <button class="race-btn" data-race="Hispanic">Hispanic</button>
            <button class="race-btn" data-race="Asian">Asian</button>
            <button class="race-btn" data-race="Native">Native</button>
          </div>
        </div>

        <!-- ---- CHART 1: Rent Burden Trend Over Time ---- -->
        <div class="chart-block">
          <p class="chart-title">Rent Burden Trend <span class="chart-subtitle">(% paying &gt;50% of income on rent)</span></p>
          <!-- MHA implementation reference line at 2019 noted in chart -->
          <div id="trend-chart"></div>
          <p class="chart-note">▲ 2019 MHA policy implemented citywide</p>
        </div>

        <!-- ---- CHART 2: Burden by Race for Selected Year ---- -->
        <div class="chart-block">
          <p class="chart-title">Burden by Group <span id="chart2-year-label" class="chart-subtitle">(2022)</span></p>
          <div id="race-chart"></div>
        </div>

        <!-- ---- RENTER INCOME CHART ---- -->
        <div class="chart-block">
          <p class="chart-title">Renter Households by Income Bracket <span class="chart-subtitle">(count)</span></p>
          <div id="income-chart"></div>
        </div>

        <!-- Reset button -->
        <button id="reset-btn">↺ Reset Dashboard</button>

        <!-- Data source note -->
        <p class="source-note">
          Sources: <a href="https://catalog.data.gov/dataset/mandatory-housing-affordability-mha-zones-53917" target="_blank">Seattle City GIS</a> ·
          <a href="https://data-seattlecitygis.opendata.arcgis.com" target="_blank">ACS via Seattle Open Data</a>
        </p>

      </div>
      <!-- END info-panel -->

      <!-- ===== RIGHT: MAP ===== -->
      <div id="map-container">
        <div id="map"></div>

        <!-- Legend: overlaid bottom-right of the map -->
        <div id="legend">
          <p class="legend-title">MHA Zone Tier</p>
          <div class="legend-row">
            <div class="legend-swatch" style="background:#4fc3c3;"></div>
            <span>M — Standard contribution</span>
          </div>
          <div class="legend-row">
            <div class="legend-swatch" style="background:#f5a623;"></div>
            <span>M1 — Higher contribution</span>
          </div>
          <div class="legend-row">
            <div class="legend-swatch" style="background:#e74c3c;"></div>
            <span>M2 — Highest contribution</span>
          </div>
          <div class="legend-row">
            <div class="legend-swatch" style="background:#444;"></div>
            <span>No MHA designation</span>
          </div>
          <hr class="legend-divider" />
          <p class="legend-source">MHA Zones: data.gov / Seattle City GIS</p>
        </div>

        <!-- Map layer toggle buttons overlaid top-left of the map -->
        <div id="layer-toggle">
          <p class="toggle-label">Map Layer</p>
          <button class="layer-btn active" data-layer="mha">MHA Zones</button>
          <button class="layer-btn" data-layer="none">Base Only</button>
        </div>

      </div>
      <!-- END map-container -->

    </div>
    <!-- END dashboard -->

  </div>
  <!-- END app -->

  <!-- External JS files: load order matters -->
  <script src="js/charts.js"></script>
  <script src="js/map.js"></script>
  <script src="js/panel.js"></script>
</body>
</html>
